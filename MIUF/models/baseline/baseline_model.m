function [model] = get_model()
    model = model_info;
    model.f = @f;
    model.g = @g;
    model.a = @a;
end

function [out1,out2,out3,out4,out5] = f(s,x,snext,xnext,p)
    n = size(s,1);

    % f
      out1 = zeros(n,5);
      out1(:,1) = p(2).*x(:,2).^p(5).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./p(4) - s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./x(:,1);
      out1(:,2) = -p(4).*p(6).*x(:,3).*xnext(:,2).^(-p(5)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1)) + p(4).*x(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1));
      out1(:,3) = -p(7).*snext(:,1).^p(7).*xnext(:,1).^(-p(7) + 1).*exp(snext(:,3))./snext(:,1) + p(8) + x(:,3) - 1;
      out1(:,4) = p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(xnext(:,4) + 1) - 1 + x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1)./p(4);
      out1(:,5) = x(:,5) - x(:,3).*(xnext(:,4) + 1);

if nargout >= 2

    % df/ds
      out2 = zeros(n,5,4);
      out2(:,1,1) = -p(7).*s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./(s(:,1).*x(:,1)); % d eq_1 w.r.t. k
      out2(:,1,2) = -p(2).*x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./(p(4).*s(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_1 w.r.t. mm
      out2(:,1,3) = -s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./x(:,1); % d eq_1 w.r.t. z
      out2(:,1,4) = 0; % d eq_1 w.r.t. u
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = p(4).*x(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(s(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_2 w.r.t. mm
      out2(:,2,3) = 0; % d eq_2 w.r.t. z
      out2(:,2,4) = 0; % d eq_2 w.r.t. u
      out2(:,3,1) = 0; % d eq_3 w.r.t. k
      out2(:,3,2) = 0; % d eq_3 w.r.t. mm
      out2(:,3,3) = 0; % d eq_3 w.r.t. z
      out2(:,3,4) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = 0; % d eq_4 w.r.t. k
      out2(:,4,2) = -p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(s(:,2).*(xnext(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) - p(5).*x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1)./(p(4).*s(:,2)); % d eq_4 w.r.t. mm
      out2(:,4,3) = 0; % d eq_4 w.r.t. z
      out2(:,4,4) = 0; % d eq_4 w.r.t. u
      out2(:,5,1) = 0; % d eq_5 w.r.t. k
      out2(:,5,2) = 0; % d eq_5 w.r.t. mm
      out2(:,5,3) = 0; % d eq_5 w.r.t. z
      out2(:,5,4) = 0; % d eq_5 w.r.t. u

    % df/dx
      out3 = zeros(n,5,5);
      out3(:,1,1) = p(2).*p(1).*x(:,2).^p(5).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./(p(4).*(-x(:,1) + 1)) - s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).^2.*exp(s(:,3))./x(:,1).^2 + s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./x(:,1).^2; % d eq_1 w.r.t. n
      out3(:,1,2) = -p(2).*x(:,2).^p(5).*x(:,2).^(-p(5) + 1).*(-p(3) + p(5)).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) + p(2).*p(5).*x(:,2).^p(5).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./(p(4).*x(:,2)); % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. R
      out3(:,1,4) = p(2).*x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(-x(:,1) + 1).^(-p(1)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1))./(p(4).*(x(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_1 w.r.t. PI
      out3(:,1,5) = 0; % d eq_1 w.r.t. I
      out3(:,2,1) = 0; % d eq_2 w.r.t. n
      out3(:,2,2) = p(4).^2.*x(:,2).^(-p(5)).*x(:,2).^(-p(5) + 1).*(-p(3) + p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) - p(4).*p(5).*x(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./x(:,2); % d eq_2 w.r.t. c
      out3(:,2,3) = -p(4).*p(6).*xnext(:,2).^(-p(5)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1)); % d eq_2 w.r.t. R
      out3(:,2,4) = -p(4).*x(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((x(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_2 w.r.t. PI
      out3(:,2,5) = 0; % d eq_2 w.r.t. I
      out3(:,3,1) = 0; % d eq_3 w.r.t. n
      out3(:,3,2) = 0; % d eq_3 w.r.t. c
      out3(:,3,3) = 1; % d eq_3 w.r.t. R
      out3(:,3,4) = 0; % d eq_3 w.r.t. PI
      out3(:,3,5) = 0; % d eq_3 w.r.t. I
      out3(:,4,1) = 0; % d eq_4 w.r.t. n
      out3(:,4,2) = -p(4).*p(6).*x(:,2).^p(5).*x(:,2).^(-p(5) + 1).*xnext(:,2).^(-p(5)).*(-p(3) + p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(xnext(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) + p(5).*p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(xnext(:,4) + 1)) + p(5).*x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1)./(p(4).*x(:,2)); % d eq_4 w.r.t. c
      out3(:,4,3) = 0; % d eq_4 w.r.t. R
      out3(:,4,4) = p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((x(:,4) + 1).*(xnext(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) + p(5).*x(:,2).^p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1)./(p(4).*(x(:,4) + 1)); % d eq_4 w.r.t. PI
      out3(:,4,5) = 0; % d eq_4 w.r.t. I
      out3(:,5,1) = 0; % d eq_5 w.r.t. n
      out3(:,5,2) = 0; % d eq_5 w.r.t. c
      out3(:,5,3) = -xnext(:,4) - 1; % d eq_5 w.r.t. R
      out3(:,5,4) = 0; % d eq_5 w.r.t. PI
      out3(:,5,5) = 1; % d eq_5 w.r.t. I

    % df/dsnext
      out4 = zeros(n,5,4);
      out4(:,1,1) = 0; % d eq_1 w.r.t. k(1)
      out4(:,1,2) = 0; % d eq_1 w.r.t. mm(1)
      out4(:,1,3) = 0; % d eq_1 w.r.t. z(1)
      out4(:,1,4) = 0; % d eq_1 w.r.t. u(1)
      out4(:,2,1) = 0; % d eq_2 w.r.t. k(1)
      out4(:,2,2) = -p(4).*p(6).*x(:,3).*xnext(:,2).^(-p(5)).*(snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(snext(:,2).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_2 w.r.t. mm(1)
      out4(:,2,3) = 0; % d eq_2 w.r.t. z(1)
      out4(:,2,4) = 0; % d eq_2 w.r.t. u(1)
      out4(:,3,1) = -p(7).^2.*snext(:,1).^p(7).*xnext(:,1).^(-p(7) + 1).*exp(snext(:,3))./snext(:,1).^2 + p(7).*snext(:,1).^p(7).*xnext(:,1).^(-p(7) + 1).*exp(snext(:,3))./snext(:,1).^2; % d eq_3 w.r.t. k(1)
      out4(:,3,2) = 0; % d eq_3 w.r.t. mm(1)
      out4(:,3,3) = -p(7).*snext(:,1).^p(7).*xnext(:,1).^(-p(7) + 1).*exp(snext(:,3))./snext(:,1); % d eq_3 w.r.t. z(1)
      out4(:,3,4) = 0; % d eq_3 w.r.t. u(1)
      out4(:,4,1) = 0; % d eq_4 w.r.t. k(1)
      out4(:,4,2) = p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(snext(:,2).*(xnext(:,4) + 1).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_4 w.r.t. mm(1)
      out4(:,4,3) = 0; % d eq_4 w.r.t. z(1)
      out4(:,4,4) = 0; % d eq_4 w.r.t. u(1)
      out4(:,5,1) = 0; % d eq_5 w.r.t. k(1)
      out4(:,5,2) = 0; % d eq_5 w.r.t. mm(1)
      out4(:,5,3) = 0; % d eq_5 w.r.t. z(1)
      out4(:,5,4) = 0; % d eq_5 w.r.t. u(1)

    % df/dxnext
      out5 = zeros(n,5,5);
      out5(:,1,1) = 0; % d eq_1 w.r.t. n(1)
      out5(:,1,2) = 0; % d eq_1 w.r.t. c(1)
      out5(:,1,3) = 0; % d eq_1 w.r.t. R(1)
      out5(:,1,4) = 0; % d eq_1 w.r.t. PI(1)
      out5(:,1,5) = 0; % d eq_1 w.r.t. I(1)
      out5(:,2,1) = 0; % d eq_2 w.r.t. n(1)
      out5(:,2,2) = -p(4).^2.*p(6).*x(:,3).*xnext(:,2).^(-p(5)).*xnext(:,2).^(-p(5) + 1).*(-p(3) + p(5)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(xnext(:,2).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) + p(4).*p(5).*p(6).*x(:,3).*xnext(:,2).^(-p(5)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./xnext(:,2); % d eq_2 w.r.t. c(1)
      out5(:,2,3) = 0; % d eq_2 w.r.t. R(1)
      out5(:,2,4) = p(4).*p(6).*x(:,3).*xnext(:,2).^(-p(5)).*(snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((xnext(:,4) + 1).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_2 w.r.t. PI(1)
      out5(:,2,5) = 0; % d eq_2 w.r.t. I(1)
      out5(:,3,1) = -p(7).*snext(:,1).^p(7).*xnext(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(snext(:,3))./(snext(:,1).*xnext(:,1)); % d eq_3 w.r.t. n(1)
      out5(:,3,2) = 0; % d eq_3 w.r.t. c(1)
      out5(:,3,3) = 0; % d eq_3 w.r.t. R(1)
      out5(:,3,4) = 0; % d eq_3 w.r.t. PI(1)
      out5(:,3,5) = 0; % d eq_3 w.r.t. I(1)
      out5(:,4,1) = 0; % d eq_4 w.r.t. n(1)
      out5(:,4,2) = p(4).*p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*xnext(:,2).^(-p(5) + 1).*(-p(3) + p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(xnext(:,2).*(xnext(:,4) + 1).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) - p(5).*p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(xnext(:,2).*(xnext(:,4) + 1)); % d eq_4 w.r.t. c(1)
      out5(:,4,3) = 0; % d eq_4 w.r.t. R(1)
      out5(:,4,4) = -p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((xnext(:,4) + 1).^2.*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) - p(6).*x(:,2).^p(5).*xnext(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^(-(-p(3) + p(5))./(-p(5) + 1)).*(p(4).*xnext(:,2).^(-p(5) + 1) + (snext(:,2)./(xnext(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(xnext(:,4) + 1).^2; % d eq_4 w.r.t. PI(1)
      out5(:,4,5) = 0; % d eq_4 w.r.t. I(1)
      out5(:,5,1) = 0; % d eq_5 w.r.t. n(1)
      out5(:,5,2) = 0; % d eq_5 w.r.t. c(1)
      out5(:,5,3) = 0; % d eq_5 w.r.t. R(1)
      out5(:,5,4) = -x(:,3); % d eq_5 w.r.t. PI(1)
      out5(:,5,5) = 0; % d eq_5 w.r.t. I(1)

end

        
end

function [out1,out2,out3] = g(s,x,e,p)
    n = size(s,1);

    % g

      out1 = zeros(n,4);
      out1(:,1) = -x(:,2) + s(:,1).*(-p(8) + 1) + s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3));
      out1(:,2) = s(:,2).*(p(10).*s(:,4) + p(9) + p(11).*s(:,3) + e(:,2) + 1)./(x(:,4) + 1);
      out1(:,3) = p(12).*s(:,3) + e(:,1);
      out1(:,4) = p(10).*s(:,4) + p(11).*s(:,3) + e(:,2);

if nargout >=2
    % dg/ds
          out2 = zeros(n,4,4);
      out2(:,1,1) = p(7).*s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3))./s(:,1) - p(8) + 1; % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. mm
      out2(:,1,3) = s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3)); % d eq_1 w.r.t. z
      out2(:,1,4) = 0; % d eq_1 w.r.t. u
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = (p(10).*s(:,4) + p(9) + p(11).*s(:,3) + e(:,2) + 1)./(x(:,4) + 1); % d eq_2 w.r.t. mm
      out2(:,2,3) = p(11).*s(:,2)./(x(:,4) + 1); % d eq_2 w.r.t. z
      out2(:,2,4) = p(10).*s(:,2)./(x(:,4) + 1); % d eq_2 w.r.t. u
      out2(:,3,1) = 0; % d eq_3 w.r.t. k
      out2(:,3,2) = 0; % d eq_3 w.r.t. mm
      out2(:,3,3) = p(12); % d eq_3 w.r.t. z
      out2(:,3,4) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = 0; % d eq_4 w.r.t. k
      out2(:,4,2) = 0; % d eq_4 w.r.t. mm
      out2(:,4,3) = p(11); % d eq_4 w.r.t. z
      out2(:,4,4) = p(10); % d eq_4 w.r.t. u
    % dg/dx
          out3 = zeros(n,4,5);
      out3(:,1,1) = s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./x(:,1); % d eq_1 w.r.t. n
      out3(:,1,2) = -1; % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. R
      out3(:,1,4) = 0; % d eq_1 w.r.t. PI
      out3(:,1,5) = 0; % d eq_1 w.r.t. I
      out3(:,2,1) = 0; % d eq_2 w.r.t. n
      out3(:,2,2) = 0; % d eq_2 w.r.t. c
      out3(:,2,3) = 0; % d eq_2 w.r.t. R
      out3(:,2,4) = -s(:,2).*(p(10).*s(:,4) + p(9) + p(11).*s(:,3) + e(:,2) + 1)./(x(:,4) + 1).^2; % d eq_2 w.r.t. PI
      out3(:,2,5) = 0; % d eq_2 w.r.t. I
      out3(:,3,1) = 0; % d eq_3 w.r.t. n
      out3(:,3,2) = 0; % d eq_3 w.r.t. c
      out3(:,3,3) = 0; % d eq_3 w.r.t. R
      out3(:,3,4) = 0; % d eq_3 w.r.t. PI
      out3(:,3,5) = 0; % d eq_3 w.r.t. I
      out3(:,4,1) = 0; % d eq_4 w.r.t. n
      out3(:,4,2) = 0; % d eq_4 w.r.t. c
      out3(:,4,3) = 0; % d eq_4 w.r.t. R
      out3(:,4,4) = 0; % d eq_4 w.r.t. PI
      out3(:,4,5) = 0; % d eq_4 w.r.t. I
end
        
end

function [out1,out2,out3] = a(s,x,p)
    n = size(s,1);

    % a

      out1 = zeros(n,7);
      out1(:,1) = s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3));
      out1(:,2) = p(9) + s(:,4);
      out1(:,3) = p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1);
      out1(:,4) = s(:,2)./(x(:,4) + 1);
      out1(:,5) = p(4).*x(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1));
      out1(:,6) = (s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1));
      out1(:,7) = p(2).*(-x(:,1) + 1).^(-p(1));

if nargout >=2
    % da/ds
          out2 = zeros(n,7,4);
      out2(:,1,1) = p(7).*s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3))./s(:,1); % d eq_1 w.r.t. k
      out2(:,1,2) = 0; % d eq_1 w.r.t. mm
      out2(:,1,3) = s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*exp(s(:,3)); % d eq_1 w.r.t. z
      out2(:,1,4) = 0; % d eq_1 w.r.t. u
      out2(:,2,1) = 0; % d eq_2 w.r.t. k
      out2(:,2,2) = 0; % d eq_2 w.r.t. mm
      out2(:,2,3) = 0; % d eq_2 w.r.t. z
      out2(:,2,4) = 1; % d eq_2 w.r.t. u
      out2(:,3,1) = 0; % d eq_3 w.r.t. k
      out2(:,3,2) = (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1).*(-p(5) + 1)./s(:,2); % d eq_3 w.r.t. mm
      out2(:,3,3) = 0; % d eq_3 w.r.t. z
      out2(:,3,4) = 0; % d eq_3 w.r.t. u
      out2(:,4,1) = 0; % d eq_4 w.r.t. k
      out2(:,4,2) = 1./(x(:,4) + 1); % d eq_4 w.r.t. mm
      out2(:,4,3) = 0; % d eq_4 w.r.t. z
      out2(:,4,4) = 0; % d eq_4 w.r.t. u
      out2(:,5,1) = 0; % d eq_5 w.r.t. k
      out2(:,5,2) = p(4).*x(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(s(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_5 w.r.t. mm
      out2(:,5,3) = 0; % d eq_5 w.r.t. z
      out2(:,5,4) = 0; % d eq_5 w.r.t. u
      out2(:,6,1) = 0; % d eq_6 w.r.t. k
      out2(:,6,2) = -p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./s(:,2) + (s(:,2)./(x(:,4) + 1)).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).^2.*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(s(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_6 w.r.t. mm
      out2(:,6,3) = 0; % d eq_6 w.r.t. z
      out2(:,6,4) = 0; % d eq_6 w.r.t. u
      out2(:,7,1) = 0; % d eq_7 w.r.t. k
      out2(:,7,2) = 0; % d eq_7 w.r.t. mm
      out2(:,7,3) = 0; % d eq_7 w.r.t. z
      out2(:,7,4) = 0; % d eq_7 w.r.t. u
    % da/dx
          out3 = zeros(n,7,5);
      out3(:,1,1) = s(:,1).^p(7).*x(:,1).^(-p(7) + 1).*(-p(7) + 1).*exp(s(:,3))./x(:,1); % d eq_1 w.r.t. n
      out3(:,1,2) = 0; % d eq_1 w.r.t. c
      out3(:,1,3) = 0; % d eq_1 w.r.t. R
      out3(:,1,4) = 0; % d eq_1 w.r.t. PI
      out3(:,1,5) = 0; % d eq_1 w.r.t. I
      out3(:,2,1) = 0; % d eq_2 w.r.t. n
      out3(:,2,2) = 0; % d eq_2 w.r.t. c
      out3(:,2,3) = 0; % d eq_2 w.r.t. R
      out3(:,2,4) = 0; % d eq_2 w.r.t. PI
      out3(:,2,5) = 0; % d eq_2 w.r.t. I
      out3(:,3,1) = 0; % d eq_3 w.r.t. n
      out3(:,3,2) = p(4).*x(:,2).^(-p(5) + 1).*(-p(5) + 1)./x(:,2); % d eq_3 w.r.t. c
      out3(:,3,3) = 0; % d eq_3 w.r.t. R
      out3(:,3,4) = -(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1).*(-p(5) + 1)./(x(:,4) + 1); % d eq_3 w.r.t. PI
      out3(:,3,5) = 0; % d eq_3 w.r.t. I
      out3(:,4,1) = 0; % d eq_4 w.r.t. n
      out3(:,4,2) = 0; % d eq_4 w.r.t. c
      out3(:,4,3) = 0; % d eq_4 w.r.t. R
      out3(:,4,4) = -s(:,2)./(x(:,4) + 1).^2; % d eq_4 w.r.t. PI
      out3(:,4,5) = 0; % d eq_4 w.r.t. I
      out3(:,5,1) = 0; % d eq_5 w.r.t. n
      out3(:,5,2) = p(4).^2.*x(:,2).^(-p(5)).*x(:,2).^(-p(5) + 1).*(-p(3) + p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))) - p(4).*p(5).*x(:,2).^(-p(5)).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./x(:,2); % d eq_5 w.r.t. c
      out3(:,5,3) = 0; % d eq_5 w.r.t. R
      out3(:,5,4) = -p(4).*x(:,2).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((x(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_5 w.r.t. PI
      out3(:,5,5) = 0; % d eq_5 w.r.t. I
      out3(:,6,1) = 0; % d eq_6 w.r.t. n
      out3(:,6,2) = p(4).*x(:,2).^(-p(5) + 1).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(3) + p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,2).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_6 w.r.t. c
      out3(:,6,3) = 0; % d eq_6 w.r.t. R
      out3(:,6,4) = p(5).*(s(:,2)./(x(:,4) + 1)).^(-p(5)).*(-p(4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./(x(:,4) + 1) - (s(:,2)./(x(:,4) + 1)).^(-p(5)).*(s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(3) + p(5)).*(-p(4) + 1).^2.*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1)).^((-p(3) + p(5))./(-p(5) + 1))./((x(:,4) + 1).*(p(4).*x(:,2).^(-p(5) + 1) + (s(:,2)./(x(:,4) + 1)).^(-p(5) + 1).*(-p(4) + 1))); % d eq_6 w.r.t. PI
      out3(:,6,5) = 0; % d eq_6 w.r.t. I
      out3(:,7,1) = p(2).*p(1).*(-x(:,1) + 1).^(-p(1))./(-x(:,1) + 1); % d eq_7 w.r.t. n
      out3(:,7,2) = 0; % d eq_7 w.r.t. c
      out3(:,7,3) = 0; % d eq_7 w.r.t. R
      out3(:,7,4) = 0; % d eq_7 w.r.t. PI
      out3(:,7,5) = 0; % d eq_7 w.r.t. I
end
                    
end

function [out1] = model_info() % informations about the model

    mod = struct;
    mod.states = { 'k','mm','z','u' };
    mod.controls = { 'n','c','R','PI','I' };
    mod.auxiliaries = { 'y','theta','X','m','uc','um','un' };
    mod.parameters = { 'eta','Psi','Phi','a','b','beta','alpha','delta','theta_ss','gamma','varphi','rho','sigma_z','sigma_u','H' };
    mod.s_ss = [15.9210924096 ; 1.4354499511 ; 0.0 ; 0.0];
    mod.x_ss = [0.33 ; 1.0296677196 ; 1.0111223458 ; 0.0125 ; 1.0111223458];
    mod.params = [ 1.          1.56214685  2.          0.95        2.56        0.989       0.36  0.019       0.0125      0.5         0.          0.95        0.007       0.0089  0.16438314];
    mod.X = cell(2,1);
    mod.X{1} = [ 0.33        1.02966772  1.01112235  0.0125      1.01112235];
    mod.X{2} = [[ -9.05955502e-03   5.10419769e-18   1.50376381e-01  -2.56858560e-04 ;   2.37669902e-02   5.35609316e-17   3.14428217e-01  -7.45850616e-03 ;  -1.67738372e-03   3.08240510e-18   3.45147946e-02  -1.93266164e-05 ;  -3.20116509e-02   7.05353746e-01  -2.64029366e-01   8.91910287e-01 ;  -5.31466264e-04   9.12375336e-17   2.77737325e-03   5.44064593e-02]];
    out1 = mod;

end
